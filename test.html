<!DOCTYPE html>
<html>
<head>
    <title>Speech-to-Text Demo</title>
</head>
<body>
    <h1>Speech-to-Text Demo</h1>
    <button id="startRecording">Start Recording</button>
    <div id="output"></div>

    <script src="https://cdn.jsdelivr.net/npm/@google-cloud/speech"></script>
    <script>
        // Import thư viện của Google Cloud Speech-to-Text API
        const { SpeechClient } = google.cloud.speech.v1p1beta1;
        const client = new SpeechClient();
        

        // Lắng nghe sự kiện click vào nút "Start Recording"
        const startRecordingButton = document.getElementById('startRecording');
        startRecordingButton.addEventListener('click', recordAudio);

        // Hàm ghi âm và chuyển đổi giọng nói thành văn bản
        async function recordAudio() {
            const recognition = new window.webkitSpeechRecognition();
            recognition.lang = 'en-US'; // Ngôn ngữ bạn muốn nhận dạng
            recognition.start(); // Bắt đầu ghi âm
            recognition.onresult = async (event) => {
                const speechToText = event.results[0][0].transcript;
                document.getElementById('output').innerText = 'Processing...';

                // Gửi âm thanh đã ghi cho Google Speech-to-Text API
                const [response] = await client.recognize({
                    config: {
                        encoding: 'LINEAR16', // Định dạng âm thanh, LINEAR16 là một định dạng phổ biến cho âm thanh WAV
                        sampleRateHertz: 16000, // Tốc độ mẫu âm thanh, 16000 Hz là một tốc độ phổ biến
                        languageCode: 'en-US', // Ngôn ngữ của âm thanh
                    },
                    audio: {
                        content: event.results[0][0].transcript,
                    },
                });

                // Lấy văn bản đã nhận dạng từ API và hiển thị lên trang web
                const transcription = response.results
                    .map(result => result.alternatives[0].transcript)
                    .join('\n');
                document.getElementById('output').innerText = transcription;
            };
        }
    </script>
</body>
</html>
